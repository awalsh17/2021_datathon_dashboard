server <- function(input, output) {
  
  # The data
  # - Might wanna think about data structure for multiple plot dfs
  # - Packing dfs into a list in a single reactive(Val)?
  dat <- reactive({
    mtcars[1:input$user_number,]
  })
  
  # Scatter plot on panel 1
  output$Plot1Output <- renderPlot({
    ggplot(dat()) +
      geom_point(
        aes(hp, mpg, fill = factor(cyl)),
        pch = 21, stroke = .7, color = "white",
        show.legend = FALSE
      ) +
      labs(
        title = glue("The letter is {input$user_letters}"),
        subtitle = glue("First {input$user_number} observations")
      )
  }, res = 150)
  
  # Density plot on panel 2
  output$Plot2Output <- renderPlot({
    ggplot(dat()) +
      geom_density(
        aes(mpg, fill = factor(cyl)),
        alpha = .5, color = 'white',
        show.legend = FALSE
      ) +
      labs(
        title = "This is a plot title"
      )
  }, res = 150)
  
  # Reactable on row 2
  output$TableOutput <- renderReactable({
    reactable(dat())
  })
  
  # Debugging button
  observeEvent(input$Debugger, {browser()})
  
}
